<div class="page-header">
  <div>
    <h1>{{ 'persons.title' | transloco }}</h1>
  </div>
  <div class="header-actions">
    <button class="ghost-btn" (click)="loadPersons()" [disabled]="loading">
      <mat-icon svgIcon="refresh"></mat-icon>
      {{ 'common.refresh' | transloco }}
    </button>
    <button class="primary-btn" (click)="openDialog()">
      <mat-icon svgIcon="add"></mat-icon>
      {{ 'common.add' | transloco }}
    </button>
  </div>
</div>

<div class="surface">
  <div class="filters-line">
    <div class="search-bar">
      <mat-icon svgIcon="search"></mat-icon>
      <input
        type="text"
        [(ngModel)]="search"
        (keyup.enter)="applySearch()"
        placeholder="{{ 'common.search' | transloco }}"
        aria-label="Recherche nom ou email"
      />
      <button mat-icon-button *ngIf="search" (click)="search=''; applySearch()" aria-label="Effacer">
        <mat-icon svgIcon="close"></mat-icon>
      </button>
    </div>

    <span class="result-badge" aria-live="polite">RÃ©sultats: {{ total }}</span>

    <button mat-stroked-button color="primary" class="filter-btn" (click)="applySearch()" [disabled]="loading">
      {{ 'common.filter' | transloco }}
    </button>
    <button mat-button class="filter-btn" (click)="search=''; applySearch()" [disabled]="loading">
      {{ 'common.reset' | transloco }}
    </button>
  </div>

  <ng2-smart-table
    [settings]="settings"
    [source]="source"
    (custom)="onCustom($event)"
    class="smart-table"
  ></ng2-smart-table>

  <mat-paginator
    [length]="total"
    [pageSize]="pageSize"
    [pageIndex]="pageIndex"
    [pageSizeOptions]="[5, 10, 20]"
    (page)="onPageChange($event)"
  ></mat-paginator>
</div>
